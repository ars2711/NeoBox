{% extends "layout.html" %} {% block title %}Timer{% endblock %} {% block main
%}
<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <div class="card shadow text-center">
        <div class="card-body">
          <h3 class="card-title mb-3"><i class="bi bi-stopwatch"></i> Timer</h3>
          <div class="mb-3">
            <svg id="timerCircle" width="140" height="140">
              <circle
                cx="70"
                cy="70"
                r="60"
                stroke="#e9ecef"
                stroke-width="12"
                fill="none"
              />
              <circle
                id="timerProgress"
                cx="70"
                cy="70"
                r="60"
                stroke="#fd7e14"
                stroke-width="12"
                fill="none"
                stroke-linecap="round"
                stroke-dasharray="377"
                stroke-dashoffset="377"
              />
              <text
                id="timerTimeText"
                x="70"
                y="80"
                text-anchor="middle"
                font-size="2em"
                fill="#212529"
              >
                00:00
              </text>
            </svg>
          </div>
          <div
            class="mb-3 d-flex justify-content-center align-items-center gap-2"
          >
            <input
              type="number"
              id="minutes"
              class="form-control form-control-sm"
              placeholder="Min"
              min="0"
              style="width: 80px"
            />
            <input
              type="number"
              id="seconds"
              class="form-control form-control-sm"
              placeholder="Sec"
              min="0"
              max="59"
              style="width: 80px"
            />
            <button class="btn btn-outline-primary btn-sm" onclick="setTimer()">
              Set
            </button>
          </div>
          <div class="mb-3">
            <button
              class="btn btn-primary me-2"
              onclick="startTimer()"
              id="timerStartBtn"
            >
              <i class="bi bi-play-fill"></i> Start
            </button>
            <button class="btn btn-secondary" onclick="resetTimer()">
              <i class="bi bi-arrow-counterclockwise"></i> Reset
            </button>
          </div>
          <div id="timerStatus" class="mt-2 small text-muted"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  let timerSet = 0,
    timerLeft = 0,
    timerInterval,
    timerRunning = false;
  function updateTimer() {
    let m = Math.floor(timerLeft / 60),
      s = timerLeft % 60;
    document.getElementById("timerTimeText").textContent = `${m
      .toString()
      .padStart(2, 0)}:${s.toString().padStart(2, 0)}`;
    let percent = timerSet ? timerLeft / timerSet : 0;
    let offset = 377 * (1 - percent);
    document
      .getElementById("timerProgress")
      .setAttribute("stroke-dashoffset", offset);
  }
  function setTimer() {
    let m = parseInt(document.getElementById("minutes").value) || 0;
    let s = parseInt(document.getElementById("seconds").value) || 0;
    timerSet = timerLeft = m * 60 + s;
    updateTimer();
    document.getElementById("timerStatus").textContent = "";
  }
  function startTimer() {
    if (timerRunning || timerLeft <= 0) return;
    timerRunning = true;
    document.getElementById("timerStartBtn").disabled = true;
    timerInterval = setInterval(() => {
      if (timerLeft > 0) {
        timerLeft--;
        updateTimer();
      } else {
        clearInterval(timerInterval);
        timerRunning = false;
        document.getElementById("timerStartBtn").disabled = false;
        document.getElementById("timerStatus").textContent = "Time's up!";
      }
    }, 1000);
  }
  function resetTimer() {
    clearInterval(timerInterval);
    timerLeft = timerSet;
    updateTimer();
    timerRunning = false;
    document.getElementById("timerStartBtn").disabled = false;
    document.getElementById("timerStatus").textContent = "";
  }
  updateTimer();
</script>
{% endblock %}
